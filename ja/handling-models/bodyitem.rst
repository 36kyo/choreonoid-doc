
Bodyアイテム
============

Bodyアイテムとは
----------------

Choreonoid上でロボットに関わる機能を利用する際には、
まずロボットや環境物体のモデルを読み込み、それらのモデルに対して操作するというのが基本になります。
「Bodyアイテム」とは、そのようなロボットや環境物体のモデルに対応するプロジェクトアイテムで、
Choreonoidの標準添付プラグインのひとつである「Bodyプラグイン」で定義されています。

モデルファイル
--------------

Bodyアイテムは、ロボットや環境物体のモデルを記述した「モデルファイル」を読み込むことで生成します。
世の中には様々な形式のモデルファイルがありますが、現在のところ読み込み可能なモデルファイル形式として、
ロボットシミュレータOpenHRPで定義されたモデルファイル形式（OpenHRP形式）があります。
OpenHRP形式は3Dモデルを記述する標準規格である Virtual Reality Modeling Language (VRML) 97 形式を拡張して定義されており、
ファイルには通常 VRML97 の拡張子である "wrl" が拡張子としてつきます。
また、モデルファイルに対して追加の情報を記述したYAML形式(拡張子 yaml）のファイルを読み込むことも可能です。

.. note:: OpenHRP形式以外のモデルファイル形式への対応も進めており、その一環として現在のところ Collada Robot Extensions 形式の読み込みも可能です。ただしまだ実装が完全ではなく、うまく読み込めない場合もあるため、今のところは特別な理由がなければOpenHRP形式を使うようにしてください。

サンプルモデル
--------------

Choreonoidには標準で以下のようなサンプルモデルが付属していて、
share ディレクトリの model 以下に格納されています。
サンプルモデルとしては以下のようなモデルがありますので、
まずはこれらのモデルを読み込んでモデルの操作方法を確認するとよいでしょう。

================= ========================= =============================
 モデル           ファイル                  概要
================= ========================= =============================
 SR1              SR1/SR1.yaml              シンプルな二足歩行ロボットモデルのサンプル
 GR001            GR001/GR001.yaml          HPI社製二足歩行ロボット"GR001"のモデル
 PA10             PA10/PA10.yaml            三菱重工株式会社製マニピュレータ "PA10" のモデル
 Crawler          misc/crawler.wrl          シンプルなクローラ型モバイルロボットのモデル
 Tank             misc/tank.wrl             戦車型モデルのサンプル
 floor            misc/floor.wrl            床モデル
================= ========================= =============================

.. Tankのモデルファイルの名前を修正しておく


モデルの読み込み
----------------

モデルファイルの読み込みは、メインメニューの「ファイル」-「読み込み」-「OpenHRPモデルファイル」から行います。
このメニューを実行するとファイル読み込みダイアログが表示されるので、モデルファイルを選んでください。
ファイルの読み込みに成功すると、読み込んだモデルの名前でBodyアイテムが生成されます。

例えばサンプルモデルの中から、PA10モデルを読み込んでみましょう。
モデルファイルの読み込みダイアログからPA10ディレクトリにある "PA10.yaml" を選択します。
ファイルが正常に読み込まれると、アイテムツリービュー上に以下のようにモデル名が表示されます。

.. image:: images/pa10item.png

この時、メッセージビューには ::

 OpenHRP モデルファイル "/usr/local/share/choreonoid-1.5//PA10/PA10.yaml" を読み込み中
 -> 完了!

といったメッセージが出力されるかと思います。

もしモデルファイルに問題があれば、代わりにエラーメッセージが出力されますので、ファイルの内容を確認してください。



シーンビュー上での表示
----------------------

Bodyアイテムとして読み込まれたモデルは、シーンビュー上に3Dグラフィックスで表示することができます。
これを行うには、アイテムツリービュー上で、表示したいBodyアイテムのチェックをONにします。

例えばPA10モデルについて、図のようにPA10アイテムのチェックを入れます。

.. image:: images/pa10item_checked.png

するとシーンビュー上にPA10モデルのCGが表示されます。

.. image:: images/pa10scene.png

モデルを表示させたくない時は、再度アイテムのチェックを外した状態にすればOKです。


Bodyアイテムのプロパティ
------------------------

Bodyアイテムを選択状態にすると、プロパティビューに選択したBodyアイテムのプロパティ一覧が表示されます。
PA10の場合、以下のように表示されるかと思います。

.. image:: images/pa10properties.png

Bodyアイテム特有のプロパティとしては以下のようなものがあります。
