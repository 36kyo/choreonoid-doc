ゲームパッドの準備
~~~~~~~~~~~~~~~~~~

サンプルの実行にあたっては、ゲームパッドがPCに接続されていて、その状態がROSのjoyトピックとして利用可能になっている必要があります。これは通常ROSが標準で備えているjoyパッケージで実現できますが、ここではそれをChoreonoid用にアレンジした"choreonoid_joy" パッケージを使用することにします。choreonoid_joyを使用することにより、joyメッセージの軸やボタンの情報がChoroenoid標準のマッピングに変換されるので、Choreonoidがサポートしている複数のゲームパッド機種に対して共通の軸やボタンを用いて操作できるという利点があります。具体的には、


などに対応しています。（なお、対応していない機種の場合、マッピングは異なってしまいますが、全く利用できないというわけではありません。）

choreonoid_joy パッケージは、 :doc:`build-choreonoid` の手順に従っていれば、お手元のROS環境で利用可能になっているはずです。使用するゲームパッドをPCに接続し、以下のコマンドを実行することで、choreonoid_joyによるjoyトピックが利用可能となります。 ::

 rosrun choreonoid_joy node

トピックが利用可能になっているかどうかは、rostopicコマンドを用いることで確認することができます。上記手順を実行後に、 ::

 rostopic echo /joy

を実行してください。

そこでゲームパッドの軸やボタンを操作すると、その度に ::

 header: 
   seq: 5972
   stamp: 
     secs: 1573371608
     nsecs: 462914906
   frame_id: ''
 axes: [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]
 buttons: [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
 ---

といった出力がされます。これがjoyトピックとしてpublishされているjoyメッセージの内容です。

ここの ::

 axes: [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]

の部分で各軸の傾きが分かりますし、 ::

 buttons: [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

の部分で各ボタンの押し下げ状態が分かります。

ゲームパッドを適当に操作して、この情報の変化を確認できれば、joyトピックは利用可能となっています。

コマンド実行時にエラーが出る場合や、ゲームパッドを操作しても出力に変化が無い場合は、joyトピックが利用可能となっていませんので、ゲームパッドの接続やコマンド実行手順などについて確認するようにしてください。
